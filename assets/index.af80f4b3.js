var q=Object.defineProperty;var x=(r,t,e)=>t in r?q(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var S=(r,t,e)=>(x(r,typeof t!="symbol"?t+"":t,e),e);const L=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function e(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerpolicy&&(i.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?i.credentials="include":c.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(c){if(c.ep)return;c.ep=!0;const i=e(c);fetch(c.href,i)}};L();class T extends HTMLElement{constructor(){super();const e=document.querySelector("#song-item-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}}customElements.define("song-item",T);class v extends HTMLElement{constructor(){super();S(this,"onItemClick",()=>{});const n=document.querySelector("#flow-item-template").content;this.attachShadow({mode:"open"}).appendChild(n.cloneNode(!0))}connectedCallback(){this.shadowRoot.querySelector(".flow-item-box").addEventListener("click",()=>this.onItemClick(this))}}customElements.define("flow-item",v);class A extends HTMLElement{constructor(){super();const e=document.querySelector("#flow-box-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}loadData(t,e){var c;const n=(c=this.shadowRoot)==null?void 0:c.querySelector(".flow-box");n.innerHTML="",t.forEach(i=>{const d=e(i);n.appendChild(d)})}}customElements.define("flow-box",A);class R extends HTMLElement{constructor(){super();const e=document.querySelector("#rank-item-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}connectedCallback(){var e;const t=this.getAttribute("cover");if(t!=null){const n=(e=this.shadowRoot)==null?void 0:e.querySelector(".right-box");n.style.background=`url(${t})`,n.style.backgroundSize="cover",n.style.backgroundRepeat="no-repeat"}}}customElements.define("rank-item",R);class H extends HTMLElement{constructor(){super();const e=document.querySelector("#column-slide-box-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}loadData(t,e){var c;const n=(c=this.shadowRoot)==null?void 0:c.querySelector(".column-slide-box");n.innerHTML="",t.forEach(i=>{const d=e(i);n.appendChild(d)})}}customElements.define("column-slide-box",H);class M extends HTMLElement{constructor(){super();const e=document.querySelector("#column-list-item-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}connectedCallback(){const t=this.getAttribute("icon"),e=this.getAttribute("background");if(t!=null){const n=this.shadowRoot.querySelector("img");n.src=t}if(e!=null){const n=this.shadowRoot.querySelector(".song-img");n.style.background=`url(${e})`,n.style.backgroundSize="cover",n.style.backgroundRepeat="no-repeat"}}}customElements.define("column-list-item",M);class N extends HTMLElement{constructor(){super();const e=document.querySelector("#song-list-item-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}connectedCallback(){var e;const t=this.getAttribute("cover");if(t!=null){const n=(e=this.shadowRoot)==null?void 0:e.querySelector(".song-img");n.style.background=`url(${t})`,n.style.backgroundSize="cover",n.style.backgroundRepeat="no-repeat"}}}customElements.define("song-list-item",N);class $ extends HTMLElement{constructor(){super();const e=document.querySelector("#row-list-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}loadData(t,e){var c;const n=(c=this.shadowRoot)==null?void 0:c.querySelector(".row-slide-box");n.innerHTML="",t.forEach(i=>{const d=e(i);n.appendChild(d)})}}customElements.define("row-slide-box",$);class D extends HTMLElement{constructor(){super();S(this,"onSearch",()=>{});const n=document.querySelector("#search-template").content;this.attachShadow({mode:"open"}).appendChild(n.cloneNode(!0))}connectedCallback(){var h,y;const e=(h=this.shadowRoot)==null?void 0:h.querySelector(".cancel-btn"),n=(y=this.shadowRoot)==null?void 0:y.querySelector(".search-input"),c=document.querySelector("#recommend-search-page"),i=document.querySelector("#recommend-content-page"),d=document.querySelector("#search-page"),b=document.querySelector("#search-result-page");n.addEventListener("focus",()=>{e.style.display="block",c.style.display="block",i.style.display="none"}),n.addEventListener("keyup",()=>{n.value.length>0&&this.onSearch(n.value)}),e.addEventListener("click",()=>{e.style.display="none",c.style.display="none",i.style.display="block",d.style.display="block",b.style.display="none"})}}customElements.define("search-bar",D);class B extends HTMLElement{constructor(){super();const e=document.querySelector("#tab-template").content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}connectedCallback(){this.shadowRoot.querySelectorAll(".tab-item").forEach(t=>{t.addEventListener("click",()=>{var e,n;(n=(e=this.shadowRoot)==null?void 0:e.querySelector(".selected"))==null||n.classList.remove("selected"),t.classList.add("selected"),t.classList.contains("recommend")?(document.querySelector("#rank-page").style.display="none",document.querySelector("#recommend-page").style.display="block"):(document.querySelector("#recommend-page").style.display="none",document.querySelector("#rank-page").style.display="block")})})}}customElements.define("tab-header",B);const g="http://124.221.249.219:8000/api";async function I(){return await(await fetch(`${g}/recommendations`)).json()}async function P(){return await(await fetch(`${g}/ranking`)).json()}async function j(){return await(await fetch(`${g}/hot`)).json()}async function F(r){const t=await fetch(`${g}/search?keyword=${r}`);try{return await t.json()}catch{return await t.text()}}(async()=>{const r=[],t=await I(),e=await P(),n=await j(),c=document.querySelector("#offical-list"),i=document.querySelector("#intelligent-list"),d=document.querySelector("#column-list"),b=document.querySelector("#rank-list"),h=document.querySelector("#hot-key");c.loadData(t.offical,s=>{const o=document.createElement("song-list-item"),a=document.createElement("span");a.setAttribute("slot","play-count"),a.innerText=s.views.toString();const l=document.createElement("span");return l.setAttribute("slot","song-list-name"),l.innerText=s.title,o.appendChild(a),o.appendChild(l),o.setAttribute("cover",s.cover),o}),i.loadData(t.tatsujin,s=>{const o=document.createElement("song-list-item"),a=document.createElement("span");a.setAttribute("slot","play-count"),a.innerText=s.views.toString();const l=document.createElement("span");return l.setAttribute("slot","song-list-name"),l.innerText=s.title,o.appendChild(a),o.appendChild(l),o.setAttribute("cover",s.cover),o}),d.loadData(t.column,s=>{const o=document.createElement("column-list-item"),a=document.createElement("span");a.setAttribute("slot","desc"),a.innerText=s.description.toString();const l=document.createElement("span");return l.setAttribute("slot","title"),l.innerText=s.title,o.appendChild(a),o.appendChild(l),o.setAttribute("background",s.background),o.setAttribute("icon",s.icon),o}),b.loadData(e,s=>{const o=document.createElement("rank-item"),a=document.createElement("span");a.setAttribute("slot","update"),a.innerText="\u6BCF"+s.update_frequence.toString()+"\u66F4\u65B0";const l=document.createElement("span");l.setAttribute("slot","title"),l.innerText=s.title;const u=document.createElement("span");u.setAttribute("slot","play-count"),u.innerText=s.views.toString();const m=document.createElement("span");m.setAttribute("slot","1st"),m.innerHTML=`<span style="color: rgb(80, 80, 80);">${s.top3[0].title}</span>-<span style="color: rgb(162, 162, 162);">${s.top3[0].artist}</span>`;const p=document.createElement("span");p.setAttribute("slot","2nd"),p.innerHTML=`<span style="color: rgb(80, 80, 80);">${s.top3[1].title}</span>-<span style="color: rgb(162, 162, 162);">${s.top3[1].artist}</span>`;const f=document.createElement("span");return f.setAttribute("slot","3rd"),f.innerHTML=`<span style="color: rgb(80, 80, 80);">${s.top3[2].title}</span>-<span style="color: rgb(162, 162, 162);">${s.top3[2].artist}</span>`,o.appendChild(u),o.appendChild(a),o.appendChild(l),o.appendChild(m),o.appendChild(p),o.appendChild(f),o.setAttribute("cover",s.cover),o}),h.loadData(n,s=>{var u,m;const o=document.createElement("flow-item"),a=document.createElement("span"),l=(m=(u=document.querySelector("search-bar"))==null?void 0:u.shadowRoot)==null?void 0:m.querySelector(".search-input");return a.setAttribute("slot","key"),a.innerText=s,o.appendChild(a),o.onItemClick=p=>{l.value=p.innerText},o});const y=document.querySelector("search-bar"),E=document.querySelector("#search-result"),w=document.querySelector("#search-result-page"),C=document.querySelector("#search-page");y.onSearch=s=>{r.push(s),k(),(async()=>{const o=await F(s);if(o instanceof String)alert(o);else{const a=o;E.loadData(a,l=>{const u=document.createElement("song-item"),m=document.createElement("span");m.setAttribute("slot","song-name"),m.innerText=l.title;const p=document.createElement("span");return p.setAttribute("slot","artist"),p.innerText=l.artist.join(" \xB7 "),u.appendChild(m),u.appendChild(p),u}),w.style.display="block",C.style.display="none"}})()};function k(){const s=document.querySelector("#search-history");r.length===0?s.style.display="none":(s.style.display="block",s.loadData(r,o=>{const a=document.createElement("flow-item"),l=document.createElement("span");return l.setAttribute("slot","key"),l.innerText=o,a.appendChild(l),a}))}})();
